{% extends 'base.html' %}

{% block content %}

{% load staticfiles %}
    <div class="right_col" role="main">
      <div class="">
        <div class="clearfix"></div>
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>Editar máquina</h2>
                    <ul class="nav navbar-right panel_toolbox">
                      <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                      </li>
                      <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                        <ul class="dropdown-menu" role="menu">
                          <li><a href="#">Settings 1</a>
                          </li>
                          <li><a href="#">Settings 2</a>
                          </li>
                        </ul>
                      </li>
                      <li><a class="close-link"><i class="fa fa-close"></i></a>
                      </li>
                    </ul>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <form id="demo-form2" data-parsley-validate class="form-horizontal form-label-left" action="" method="post">{% csrf_token %}
                        {{ form.errors }}
                        {{ form.non_field_errors }}
                        <div class="form-group pull-in clearfix">
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-4" for="{{ nombre.id_for_label }}">Nombre </label>
                                {{ form.nombre }}
                                {{ form.nombre.errors }}
                            </div>
                            <div class="col-sm-3">
                                <label style="text-align:left;" class="control-label col-sm-4" for="{{ clasificacion.id_for_label }}">Clasificación </label>
                                {{ form.clasificacion }}
                                {{ form.clasificacion.errors }}
                            </div>
                            <div class="col-sm-3">
                                <label style="text-align:left;" class="control-label col-sm-4" for="{{ compania.id_for_label }}">Compañía </label>
                                {{ form.compania }}
                                {{ form.compania.errors }}
                            </div>
                            <div class="col-sm-4">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ conductor.id_for_label }}">Conductores</label>
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"> Seleccione <span class="caret"></span></button>
                                {{ form.conductor }}
                                {{ form.conductor.errors }}
                            </div>
                        </div>
                        <div class="form-group pull-in clearfix">
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ kilometraje.id_for_label }}">Kilometraje </label>
                                {{ form.kilometraje }}
                                {{ form.kilometraje.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ hodometro.id_for_label }}">Hodometro</label>
                                {{ form.hodometro }}
                                {{ form.hodometro.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ tiene_bomba.id_for_label }}">Tiene Bomba</label>
                                {{ form.tiene_bomba }}
                                {{ form.tiene_bomba.errors }}
                            </div>
                                <div class="col-sm-2" id="tiene_bomba">
                                    <label style="text-align:left;" class="control-label col-sm-12" for="{{ hodometro_bomba.id_for_label }}">Hodometro Bomba</label>
                                    {{ form.hodometro_bomba }}
                                    {{ form.hodometro_bomba.errors }}
                                </div>
                        </div>
                        <div class="form-group pull-in clearfix">
                            <div class="col-sm-3">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ marca.id_for_label }}">Marca </label>
                                {{ form.marca }}
                                {{ form.marca.errors }}
                            </div>
                            <div class="col-sm-3">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ modelo.id_for_label }}">Modelo </label>
                                {{ form.modelo }}
                                {{ form.modelo.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ ano.id_for_label }}">Año </label>
                                {% load l10n %}
                                {{ form.ano|unlocalize }}
                                {{ form.ano.errors }}
                            </div>
                        </div>
                        <div class="form-group pull-in clearfix">
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ patente.id_for_label }}">Patente </label>
                                {{ form.patente }}
                                {{ form.patente.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ numero_motor.id_for_label }}">Número motor </label>
                                {{ form.numero_motor }}
                                {{ form.numero_motor.errors }}
                            </div>
                            <div class="col-sm-3">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ numero_chasis.id_for_label }}">Número chasís </label>
                                {{ form.numero_chasis }}
                                {{ form.numero_chasis.errors }}
                            </div>
                            <div class="col-sm-3">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ bin.id_for_label }}">Bin </label>
                                {{ form.bin }}
                                {{ form.bin.errors }}
                            </div>
                        </div>
                        <div class="ln_solid"></div>
                        <div class="form-group pull-in clearfix">
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ venc_patente.id_for_label }}">Vencimiento Patente </label>
                                {{ form.venc_patente }}
                                {{ form.venc_patente.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ costo_patente.id_for_label }}">Valor Patente </label>
                                {{ form.costo_patente }}
                                {{ form.costo_patente.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ soap_costo.id_for_label }}">Valor SOAP </label>
                                {{ form.soap_costo }}
                                {{ form.soap_costo.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ venc_rev_tec.id_for_label }}">Venc. Rev. Técnica </label>
                                {{ form.venc_rev_tec }}
                                {{ form.venc_rev_tec.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ costo_rev_tec.id_for_label }}">Valor Rev. Técnica  </label>
                                {{ form.costo_rev_tec }}
                                {{ form.costo_rev_tec.errors }}
                            </div>
                        </div>
                        <div class="form-group pull-in clearfix">
                        <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ venc_seg_auto.id_for_label }}">Vencimiento Seguro </label>
                                {{ form.venc_seg_auto }}
                                {{ form.venc_seg_auto.errors }}
                            </div>
                            <div class="col-sm-2">
                                <label style="text-align:left;" class="control-label col-sm-12" for="{{ costo_seg_auto.id_for_label }}">Valor Seguro</label>
                                {{ form.costo_seg_auto }}
                                {{ form.costo_seg_auto.errors }}
                            </div>
                        </div>
                        <div class="ln_solid"></div>
                      <div class="form-group">
                        <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                          <button id="boton_tipo" type="submit" class="btn btn-success">Guardar</button>
                          <button type="button" onclick="location.href='{% url 'maquina_detail' pk=object.id %}';" class="btn btn-danger">Cancelar</button>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
            </div>
        </div>
      </div>
    </div>
        <!-- /page content -->

    <!-- jQuery -->
    <script type="text/javascript" src="{% static 'vendors/jquery/dist/jquery.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'smart-selects/admin/js/chainedfk.js' %}"></script>
    <!-- Bootstrap -->
    <script type="text/javascript" src="{% static 'vendors/bootstrap/dist/js/bootstrap.min.js' %}"></script>

    <script type="text/javascript" src="{% static 'js/datepicker/bootstrap-datepicker.js' %}"></script>

    <!-- Custom Theme Scripts -->
    <script type="text/javascript" src="{% static 'js/custom.js' %}"></script>

    <!-- bootstrap-daterangepicker -->
    <script>
      $(document).ready(function() {
        $('#fecha').datepicker();

        var compania = $("#id_compania").val()
        var maquina = $("#id_nombre").val();
        console.log(maquina);
        get_conductores(compania,maquina);

        var tiene_bomba = $("#id_tiene_bomba").val();
        funcion_tiene_bomba(tiene_bomba);

        $("#id_conductor").addClass("dropdown-menu");

        //$('#id_compania').block({ message: 'blocked' ,overlayCSS: { backgroundColor: '#fff'   }});

      });
    </script>

    <script>

        $("#id_compania").change(function(){
            var compania = $("#id_compania").val();
            var maquina = $("#id_nombre").val();
            get_conductores(compania,maquina);

        });

        function get_conductores(compania,maquina){
            var datos_detalle = $("#demo-form2 :hidden").serialize();
            var datos = datos_detalle+"&compania="+compania+"&maquina="+maquina;
            $.ajax({
                url: "{% url 'get_maquina_conductores' %}",
                type: "POST",
                data: datos,
                success: function (data) {
                    $("#id_conductor").empty();
                    for(var i in data.conductores) {

                        $("#id_conductor").append("<li><a href='#'' data-value='option1' tabIndex='-1'><input type='checkbox' name='conductor' value='"+data.conductores[i].id+"' id='id_conductor_"+data.conductores[i].id+"' />&nbsp;"+data.conductores[i].nombre+" "+data.conductores[i].ap_paterno+"</label>");

                        //$("#id_conductor").append("<li><a href='#'' data-value='option1' tabIndex='-1'><input type='checkbox'/>&nbsp;Option 1</a></li>");
                    }
                    for (var i in data.cond_maq){
                        $("#id_conductor_"+data.cond_maq[i].id).prop('checked', true);
                    }
                }
            });

        }

         $("#id_tiene_bomba").change(function(){
            funcion_tiene_bomba($(this).val());
         });


        function funcion_tiene_bomba(var_bool){
            console.log(var_bool);
            if(var_bool === "True"){
                $("#tiene_bomba").show();
            }
            else{
                $("#tiene_bomba").hide();
            }
        }


    /*$('#id_monto').priceFormat({
        prefix: '',
        centsSeparator: ',',
        thousandsSeparator: '.',
        centsLimit: 0
    });*/
    </script>

{% endblock %}